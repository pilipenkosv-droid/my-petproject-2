# ROADMAP: Расширение функционала SFormat

> Дата создания: 2026-02-04
> Последнее обновление: 2026-02-08
> Основано на анализе рынка EdTech РФ и текущего функционала

## Статус реализации

| Приоритет | Функции | Статус | Дата |
|-----------|---------|--------|------|
| **P1** | Чат с методичкой, Генерация плана, Сумматор | DONE | 2026-02-08 |
| **P2** | Рерайт | DONE | 2026-02-08 |
| **P2** | Telegram-бот | BACKLOG | — |
| **P3** | Проверка грамматики, Подбор литературы | DONE | 2026-02-08 |

> Все 5 инструментов (генератор плана, краткое содержание, рерайт, проверка грамматики, подбор литературы) реализованы и доступны на продакшене. Чат с методичкой интегрирован в пайплайн confirm-rules. Telegram-бот остаётся в бэклоге.

---

## ПРИОРИТЕТ 1: Quick Wins

### 1.1 Чат с методичкой (Ask Guidelines)

**Бизнес-ценность:** Конкуренты продают как premium за 499₽/мес. У нас методичка УЖЕ парсится.

#### Техническая реализация

**Этапы:**

1. **Сохранение текста методички**
   - Файл: `src/lib/storage/job-store.ts`
   - Добавить поле `guidelinesText` в JobData
   - При извлечении правил сохранять полный текст методички

2. **API endpoint**
   - Файл: `src/app/api/ask-guidelines/route.ts`
   - POST `{ jobId, question }`
   - Взять guidelinesText из job, отправить в AI с вопросом
   - Вернуть ответ

3. **UI компонент**
   - Файл: `src/features/confirm-rules/components/GuidelinesChat.tsx`
   - Чат-интерфейс на странице `/confirm-rules/[jobId]`
   - История сообщений (localStorage)

4. **Промпт**
   - Файл: `src/lib/ai/prompts.ts`
   - `createGuidelinesChatPrompt(guidelinesText, question, history)`

#### Зависимости
- Существующий AI-шлюз (`gateway.ts`)
- Существующий парсер документов (`documents/`)
- shadcn/ui компоненты (Input, Button, ScrollArea)

#### Оценка
- Бэкенд: ~50 строк кода
- Фронтенд: ~150 строк кода
- Сложность: ⭐ Очень легко

---

### 1.2 Генерация плана/структуры работы

**Бизнес-ценность:** Бесплатный "крючок" для привлечения пользователей (как у Кэмп, Zaochnik).

#### Техническая реализация

**Этапы:**

1. **API endpoint**
   - Файл: `src/app/api/generate-outline/route.ts`
   - POST `{ topic, workType, additionalRequirements? }`
   - workType: `"курсовая" | "диплом" | "реферат" | "эссе"`
   - Вернуть структуру: `{ chapters: [{ title, sections: [] }] }`

2. **UI страница**
   - Файл: `src/app/outline/page.tsx`
   - Форма: тема + тип работы + доп. требования
   - Результат: редактируемый план (drag & drop для порядка)
   - Кнопка "Скопировать" / "Скачать .txt"

3. **Промпт**
   - Файл: `src/lib/ai/prompts.ts`
   - `createOutlinePrompt(topic, workType, requirements)`
   - Учитывать типичную структуру для каждого типа работы

4. **Интеграция с основным флоу**
   - На странице `/create` добавить ссылку "Нет плана? Сгенерируем!"
   - После генерации → редирект на `/create` с подсказкой

#### Зависимости
- AI-шлюз
- @dnd-kit/core для drag & drop (опционально)

#### Оценка
- Бэкенд: ~80 строк кода
- Фронтенд: ~200 строк кода
- Сложность: ⭐ Очень легко

---

### 1.3 Сумматор текста

**Бизнес-ценность:** Востребовано для подготовки к экзаменам, создания аннотаций.

#### Техническая реализация

**Этапы:**

1. **API endpoint**
   - Файл: `src/app/api/summarize/route.ts`
   - POST `{ text?, fileId?, targetLength: "short" | "medium" | "detailed" }`
   - short: 100-200 слов, medium: 300-500, detailed: 800-1000
   - Поддержка загрузки файла или вставки текста

2. **UI страница**
   - Файл: `src/app/summarize/page.tsx`
   - Два режима ввода: текст (textarea) или файл (FileUploadZone)
   - Выбор длины результата
   - Результат с кнопками "Скопировать" / "Ещё короче" / "Подробнее"

3. **Промпт**
   - Файл: `src/lib/ai/prompts.ts`
   - `createSummaryPrompt(text, targetLength, style: "academic" | "simple")`

4. **Интеграция**
   - Добавить в навигацию "Инструменты" → "Сумматор"
   - На странице `/result` предложить "Создать аннотацию к работе"

#### Зависимости
- AI-шлюз
- Существующий FileUploadZone компонент
- Парсер документов для извлечения текста из DOCX/PDF

#### Оценка
- Бэкенд: ~60 строк кода
- Фронтенд: ~180 строк кода
- Сложность: ⭐ Очень легко

---

## ПРИОРИТЕТ 2: Расширение аудитории

### 2.1 Telegram-бот

**Бизнес-ценность:** 60%+ студентов в Telegram. Конкуренты (StudGPT, Кэмп) активно используют.

#### Техническая реализация

**Этапы:**

1. **Создание бота**
   - Зарегистрировать бота через @BotFather
   - Получить токен

2. **Серверная часть**
   - Новый проект или serverless function
   - Файл: `telegram-bot/index.ts` (или Vercel Edge Function)
   - Библиотека: grammy или node-telegram-bot-api

3. **Команды бота**
   ```
   /start - Приветствие + краткая инструкция
   /format - Начать форматирование (запросить файл)
   /outline <тема> - Сгенерировать план
   /summarize - Сократить текст (запросить файл или текст)
   /help - Справка
   /account - Статус подписки + ссылка на оплату
   ```

4. **Флоу форматирования**
   - Пользователь отправляет DOCX
   - Бот: "Есть методичка? Отправьте файл или напишите 'нет'"
   - Вызов нашего API `/api/process`
   - Polling статуса через `/api/status/[jobId]`
   - Отправка результата (2 файла)

5. **Лимиты и оплата**
   - Бесплатно: 1 форматирование + 5 запросов outline/summarize в день
   - Платно: ссылка на веб-версию для оплаты подписки
   - Проверка лимитов через существующий `/api/user/access`

6. **Хостинг**
   - Вариант A: Vercel Serverless (webhook mode)
   - Вариант B: Railway/Render (long polling)

#### Зависимости
- grammy (или node-telegram-bot-api)
- Существующие API endpoints
- Supabase для связи telegram_user_id ↔ user

#### Оценка
- Код бота: ~300-400 строк
- Сложность: ⭐⭐ Легко

---

### 2.2 Рерайт для уникальности

**Бизнес-ценность:** Топовый запрос перед сдачей работы.

#### Техническая реализация

**Этапы:**

1. **API endpoint**
   - Файл: `src/app/api/rewrite/route.ts`
   - POST `{ text, mode: "light" | "medium" | "heavy", preserveTerms?: string[] }`
   - light: минимальные изменения (синонимы)
   - medium: перестройка предложений
   - heavy: полное перефразирование с сохранением смысла

2. **UI страница**
   - Файл: `src/app/rewrite/page.tsx`
   - Split view: оригинал слева, результат справа
   - Подсветка изменений (diff)
   - Термины для сохранения (чтобы не заменял спец. слова)

3. **Промпт**
   - Файл: `src/lib/ai/prompts.ts`
   - `createRewritePrompt(text, mode, preserveTerms)`
   - Инструкция сохранять академический стиль

4. **Пакетная обработка**
   - Для больших текстов: разбивка на абзацы
   - Параллельная обработка через Promise.all
   - Прогресс-бар

5. **Интеграция**
   - На странице `/result`: "Повысить уникальность текста"
   - В Telegram-боте: `/rewrite` команда

#### Зависимости
- AI-шлюз
- diff библиотека для подсветки изменений (diff-match-patch)

#### Оценка
- Бэкенд: ~100 строк кода
- Фронтенд: ~250 строк кода
- Сложность: ⭐⭐ Легко

---

## ПРИОРИТЕТ 3: Полная экосистема

### 3.1 Проверка грамматики

**Бизнес-ценность:** Добавляет ценность без больших затрат (LanguageTool бесплатный).

#### Техническая реализация

**Этапы:**

1. **Интеграция LanguageTool API**
   - Файл: `src/lib/grammar/language-tool.ts`
   - Public API: https://api.languagetool.org/v2/check
   - Лимит: 20 запросов/мин (бесплатно), или self-hosted

2. **API endpoint**
   - Файл: `src/app/api/check-grammar/route.ts`
   - POST `{ text }` или `{ jobId }` (взять текст из документа)
   - Вернуть: `{ errors: [{ offset, length, message, suggestions, rule }] }`

3. **Интеграция в основной флоу**
   - На странице `/result` добавить вкладку "Грамматика"
   - Показывать ошибки рядом с нарушениями форматирования
   - Подсветка в тексте + suggestions

4. **UI компонент**
   - Файл: `src/features/result/components/GrammarPanel.tsx`
   - Список ошибок с категориями (орфография, пунктуация, стиль)
   - Клик по ошибке → scroll к месту в документе

5. **Добавить в отформатированный документ**
   - Опционально: комментарии Word с грамматическими ошибками

#### Зависимости
- LanguageTool API (бесплатный tier или self-hosted)
- Существующий парсер документов

#### Оценка
- Бэкенд: ~80 строк кода
- Фронтенд: ~200 строк кода
- Сложность: ⭐⭐ Легко-средне

---

### 3.2 Подбор литературы

**Бизнес-ценность:** Убирает боль "где искать источники". РГБ берёт 40₽/источник.

#### Техническая реализация

**Этапы:**

1. **Источники данных**
   - Google Scholar (через SerpAPI или scraping)
   - eLibrary.ru API (если доступен)
   - CrossRef API (бесплатный, для международных)
   - OpenAlex API (бесплатный, академический)

2. **API endpoint**
   - Файл: `src/app/api/find-sources/route.ts`
   - POST `{ topic, workType, count: 10-30, language: "ru" | "en" | "both" }`
   - Вернуть: `{ sources: [{ authors, title, year, journal, doi?, url? }] }`

3. **AI-валидация**
   - Проверка что источник релевантен теме
   - Фильтрация "галлюцинаций" через поиск
   - Ранжирование по релевантности

4. **Форматирование по ГОСТ**
   - Использовать существующий bibliography-formatter
   - Выдавать готовый список литературы

5. **UI страница**
   - Файл: `src/app/sources/page.tsx`
   - Ввод темы + параметры (количество, язык, годы)
   - Результат: таблица источников с чекбоксами
   - Экспорт выбранных в формате ГОСТ

6. **Интеграция**
   - На странице `/outline`: "Подобрать источники по плану"
   - В результатах форматирования: "Дополнить список литературы"

#### Зависимости
- OpenAlex API / CrossRef API (бесплатные)
- SerpAPI для Google Scholar (платный, ~$50/мес за 5000 запросов)
- Существующий bibliography-formatter

#### Оценка
- Бэкенд: ~200 строк кода
- Фронтенд: ~300 строк кода
- Сложность: ⭐⭐⭐ Средне

---

## TIMELINE (факт)

Все P1-P3 реализованы за 1 день (2026-02-08):

```
2026-02-08:
├── Чат с методичкой (Ask Guidelines) — интегрирован в confirm-rules
├── Генератор плана (/outline) — отдельная страница + API
├── Краткое содержание (/summarize) — отдельная страница + API
├── Рерайт (/rewrite) — отдельная страница + API
├── Проверка грамматики (/grammar) — LanguageTool API
├── Подбор литературы (/sources) — OpenAlex + CrossRef + AI-валидация
├── Cross-sell между инструментами (RelatedTools, pill-links, landing showcase)
├── SEO metadata для всех инструментов (layout.tsx)
├── FAQ категория «Инструменты» (7 вопросов)
└── Обновление sitemap, schema.org, footer, pricing
```

BACKLOG:
- Telegram-бот

---

## МОДЕЛЬ МОНЕТИЗАЦИИ

### Текущие тарифы

| Тариф | Цена | Обработок | Инструменты |
|-------|------|-----------|-------------|
| Trial | 0₽ | 1 (30 стр) | Базовые (грамматика, план) |
| Разовая | 159₽ | 1 полная | Базовые инструменты |
| Pro | 399₽/мес | 10/мес | Все без ограничений |

---

## МЕТРИКИ УСПЕХА

| Функция | KPI |
|---------|-----|
| Чат с методичкой | >30% пользователей задают вопрос |
| Генерация плана | >500 планов/мес, конверсия в /create >10% |
| Сумматор | >200 использований/мес |
| Telegram-бот | >1000 MAU за 3 месяца |
| Рерайт | >15% платных пользователей используют |
| Грамматика | Рост NPS на 5+ пунктов |
| Подбор литературы | >100 запросов/мес |

---

## КОНКУРЕНТНЫЙ АНАЛИЗ (справочно)

### Цены конкурентов

| Функция | Рыночная цена |
|---------|---------------|
| Генерация плана | Бесплатно / в подписке |
| Чат с документом | 499₽/мес (StudGPT) |
| Сумматор/рерайт | 250-1599₽/мес |
| Telegram-бот | Бесплатно с лимитом |
| Проверка грамматики | от 200₽/мес |
| Подбор литературы | 40₽/источник (РГБ) или 490₽/мес |

### Основные конкуренты
- **Кэмп (Kampus)** — 399₽/мес, AI-написание + верстка
- **StudGPT** — 299-499₽/мес, Telegram-бот, чат с PDF
- **Study AI** — доступ к 11+ моделям
- **DocStandart** — верстка по ГОСТ за 1 мин
- **Grafiati** — библиография по ГОСТ/APA/MLA

---

## НАШЕ КОНКУРЕНТНОЕ ПРЕИМУЩЕСТВО

1. **Полная экосистема из 6 инструментов** — форматирование, план, грамматика, рерайт, аннотация, литература
2. **Уже работающая верстка по ГОСТ** с 11+ проверками
3. **AI-шлюз с 11 провайдерами** и автоматическим fallback
4. **Cross-sell между инструментами** — каждый инструмент ведёт к другим
5. **Система подписок** уже настроена (Lava.top)
6. **SEO-оптимизация** — блог, FAQ, JSON-LD schemas, sitemap для всех страниц
